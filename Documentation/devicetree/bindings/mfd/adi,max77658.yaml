# SPDX-License-Identifier: GPL-2.0-only OR BSD-2-Clause
%YAML 1.2
---
$id: http://devicetree.org/schemas/mfd/adi,max77658.yaml#
$schema: http://devicetree.org/meta-schemas/core.yaml#

title: MAX77643/54/58/59 PMIC from ADI

maintainers:
  - Nurettin Bolucu <Nurettin.Bolucu@analog.com>
  - Zeynep Arslanbenzer <Zeynep.Arslanbenzer@analog.com>

description: |
  MAX77643, MAX77654, MAX77658 and MAX77659 devices are a family of ADI PMICs
  providing battery charging and power supply solutions for
  low-power applications.

  MAX77643 is a Power Management IC with 1 LDO regulator.

  MAX77654 is a Power Management IC with 2 LDO regulators and 1 charger.

  MAX77658 is a Power Management IC with 2 LDO regulators, 1 charger
  and 1 fuel gauge.

  MAX77659 is a Power Management IC with 1 LDO regulator and 1 charger.

properties:
  compatible:
    enum:
      - adi,max77643
      - adi,max77654
      - adi,max77658
      - adi,max77659

  reg:
    items:
      - enum: [0x40, 0x48]

  interrupts:
    maxItems: 1

  charger:
    $ref: /schemas/power/supply/max77650-charger.yaml

  regulators:
    type: object

    description:
      The regulators is represented as a sub-node of the PMIC node on the device tree.

    patternProperties:
      "^LDO[01]$":
        type: object
        $ref: /schemas/regulator/regulator.yaml
        additionalProperties: false
        description:
          LDO regulator

        properties:
          regulator-always-on: true
          regulator-boot-on: true

    additionalProperties: false

allOf:
  - if:
      properties:
        compatible:
          contains:
            enum:
              - adi,max77643
              - adi,max77654
              - adi,max77658

    then:
      properties:
        reg:
          items:
            - const: 0x48

    else:
      properties:
        reg:
          items:
            - const: 0x40

required:
  - compatible
  - reg
  - interrupts

additionalProperties: false

examples:
  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    i2c {
      #address-cells = <1>;
      #size-cells = <0>;
      pmic@48 {
        compatible = "adi,max77658";
        reg = <0x48>;
        interrupt-parent = <&gpio>;
        interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
        charger {
          compatible = "adi,max77658-charger";
          input-voltage-min-microvolt = <4200000>;
          input-current-limit-microamp = <285000>;
        };
        regulators {
          LDO0 {
            regulator-boot-on;
            regulator-always-on;
          };
          LDO1 {
            regulator-boot-on;
            regulator-always-on;
          };
        };
      };
    };

  - |
    #include <dt-bindings/interrupt-controller/irq.h>
    i2c {
      #address-cells = <1>;
      #size-cells = <0>;
      pmic@40 {
        compatible = "adi,max77659";
        reg = <0x40>;
        interrupt-parent = <&gpio>;
        interrupts = <16 IRQ_TYPE_EDGE_FALLING>;
        charger {
          compatible = "adi,max77659-charger";
        };
        regulators {
          LDO0 {
            regulator-boot-on;
            regulator-always-on;
          };
        };
      };
    };
