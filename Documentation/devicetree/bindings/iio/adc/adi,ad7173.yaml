# SPDX-License-Identifier: GPL-2.0
%YAML 1.2
---
$id: "http://devicetree.org/schemas/iio/adc/adi,ad7173.yaml#"
$schema: "http://devicetree.org/meta-schemas/core.yaml#"

title: Analog Devices AD7173 and similar Analog to Digital Converter (ADC)

maintainers:
  - Alexandru Ardelean <alexandru.ardelean@analog.com>

description: |
  Driver for Analog Devices AD7173 and similar Analog to Digital Converter (ADC)
    https://www.analog.com/en/products/ad7172-2.html
    https://www.analog.com/en/products/ad7173-8.html
    https://www.analog.com/en/products/ad7175-2.html
    https://www.analog.com/en/products/ad7176-2.html

properties:
  compatible:
    oneOf:
      - items:
          - enum:
              - adi,ad7172-2
              - adi,ad7173-8
              - adi,ad7175-2
              - adi,ad7176-2

  reg:
    description:
      The SPI chip select number of the device
    maxItems: 1

  spi-cpha:
    description:
      SPI clock phase must be set, to select SPI mode 3
    maxItems: 1

  spi-cpol:
    description:
      SPI clock polarity must be set, to select SPI mode 3
    maxItems: 1

  interrupts:
    description:
      Interrupt that triggers when the conversion is ready
    maxItems: 1

  adi,channels:
    description: |
      List of external channels connected to the ADC

patternProperties:
  '^channel@[0-9a-f]+,[0-9a-f]+$':
    description: |
      Definition for a channel provided via 'adi,channels'
    properties:
      '#address-cells':
        const: 2
      '#size-cells':
        const: 0
      reg:
        maxItems: 1
        description: |
          Pins the channel is connected to. The first value specifies the
          the positive input pin, the second value the negative input.
      adi,bipolar:
        maxItems: 1
        description: |
          If set the channel is used in bipolar mode.
    required:
      - '#address-cells'
      - '#size-cells'
      - reg

required:
  - compatible
  - reg
  - interrupts
  - spi-cpha
  - spi-cpol

examples:
  - |
    ad7173 {
        compatible = "adi,ad7173-8";
        reg = <0>;
        spi-cpol;
        spi-cpha;
        spi-max-frequency = <100000>;

        adi,channels {
                #address-cells = <2>;
                #size-cells = <0>;

                channel@0,1 {
                    reg = <0 1>;
                    adi,bipolar;
                };

                channel@2,3 {
                    reg = <2 3>;
                    adi,bipolar;
                };
        };
    };
